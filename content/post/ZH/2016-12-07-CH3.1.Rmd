---
title: "Lagrange乘子理论(1)"
author: Yutong Dai
date: '2016-12-07'
categories:
  - convex optimization
tags:
  - Lagrange乘子
slug: lag1
output:
  blogdown::html_page:
    toc: yes
summary: 该系列posts是笔者学习Dimitri .P Bertsekas所写的 Nonlinear Programming 2ed 中文版时整理的笔记。第三章Lagrange乘子理论内容涉及到等式约束优化问题及不等式约束优化问题。本文讨论等式约束优化问题。
---


通过引入一些辅助变量，即Lagrange乘子，我们可以利用他们：

* 描述最优解的特性
* 灵敏度分析
* 对自变量变化引起的目标函数的一阶导数进行定量描述

本章将沿着`惩罚法`和`可行方向法`两个角度进行讨论。

## 等式约束优化问题

### 最优解的必要条件
本节我们考虑优化问题：

$$
\text{minimize}\; f(x)\qquad\qquad\qquad\qquad\\
\text{subject to}\; h_i(x)=0,i=1,2,...,m\\
$$


其中 $f: R^n\;\vert \rightarrow R$,  $h_i: R^n\;\vert \rightarrow R$均是连续可微的。为了记号简洁性，我们引入向量值函数$h=(h_1,...,h_m)^T$,即$h: R^n\;\vert \rightarrow R^m$。 从而约束条件变为了 $h(x)=0$

Lagrange 理论解决上述优化问题的办法是，通过引入Lagrange乘子$\lambda=(\lambda_1,...,\lambda_m)^T$，构造Lagrange函数

$$L(x,\lambda)=f(x)+\lambda^T h(x)$$

转而考察$L(x,\lambda)$。该理论指出，对给定的局部最小值点$x_* $，存在向量$\lambda_* $满足

$$\nabla f(x_* )+{\lambda_* }^T\nabla h(x_* )=0$$

这个方程有两种解释:

* 目标函数的梯度$\nabla f(x_* )$属于$\{\nabla h_1(x_* ),...,\nabla h_m(x_* )\}$这个向量组张成的n维线性子空间里；
* 目标函数的梯度$\nabla f(x_* )$正交于一阶可行变分子空间，即
	
	$$V(x_* )=\{\Delta x=x-x_* \vert  (x-x_* )^T\nabla h_i(x_* )=0,i=1,2..,m\}$$
	
	注意到，$\forall \Delta x\in V(x_* )$, $\nabla h(x_* ) \Delta x=0$，从而结合上式，我们有$\Delta x^T\nabla f(x_* )=0$。
	
	**Remark**
	
	1. 一阶可行变分子空间中的元素是使得$h(x)$的一阶近似，$h(x_* )+\nabla h(x)\Delta x$，在$x+\Delta x$取值同样为0的元素构成的集合。这是对约束条件$h(.)$的性质刻画。
	2. 这里$V(x_* )$的作用类似于带约束优化问题的约束集。在Chapter2中，最优解得$x_* $满足的必要条件$\forall x\in X$为($X$是约束集)

	$$\nabla f(x_* )(x-x_* )\geq 0$$

	这里$\Delta x^T\nabla f(x_* )=0$与上述结论是相似的，同样也类似于Chapter1中提到的一阶"零梯度条件"$\nabla f(x_* )=0$
	
下面给出`Lagrange乘子定理`的严格表述

 如果 $x_* $是$f$在 $h(x)=0$约束条件下的局部最小值点，且假定梯度向量组$\{\nabla h_1(x_* ),...,\nabla h_m(x_* )\}$,线性无关，那么存在唯一的向量$\lambda_* $使得	

$$\nabla f(x_* )+{\lambda_* }^T\nabla h(x)=0\qquad (一阶条件)$$

进一步，如果$f,h$二次可微，那么有，对任意$\Delta x\in V(x_* )$,

$$\Delta x^T\big(\nabla f(x_* )+{\lambda_* }^T\nabla h(x_* )\big)\Delta x\in V(x_* )\geq 0\qquad (二阶条件)$$

**Remark**

1. 我们称可行向量$x$为正则的，若约束函数梯度$\{\nabla h_1(x),...,\nabla h_m(x)\}$线性无关。
2. 对应于一阶可行变分子空间，我们还要引入`真正可行变分集`这个概念。从一阶可行变分子空间的定义不难看出$V(x_* )=\{\Delta x\vert  \nabla h(x_* )\Delta x=0\}$。假设$x_* \in R^n$,且通常假设$m\leq n$，则$V(x_* )$是一个线性方程组的解空间，该空间的维数为$n-r( \nabla h(x_* ))\geq n-m$。当$x_* $满足正则条件式，我们就称$V(x_* )$为真正可行变分集。
3. 存在反例表明，在非正则的局部最小值点处的Lagrange乘子可以不存在。
	![Snip20161201_2](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_2.png)

	**Remark**
	从一阶可行变分子空间的角度看，由于一阶变分子空间$V(x_* )=\{(0,y_2)\vert y_2\in R\}$的维数为1，但是真正可行变分集$\{(y_1,y_2)\vert y_1=y_2=0\}$的维数为0，因此一阶变分子空间比正真可行变分集具有更高的维数。由Lagrange理论指出，$x_* $的最优性只能保证$\nabla f(x_* )$正交于可行变分集，但是要使得Lagrange乘子存在，$\nabla f(x_* )$正交于一阶变分子空间。故当$\{\nabla h_1(x),...,\nabla h_m(x)\}$线性无关时，两个变分集合是相等的。

4. 当约束条件是线性约束时，比如$AX=0$，则即使没有$\{\nabla h_1(x_* ),...,\nabla h_m(x_* )\}$线性无关也可成立，即不需要$x_* $正则的正则性,具体讨论见`消元法`这一小节。

对于该理论，我们有两种证明的方法，他们都是基于将有约束的优化问题化为无约束的优化问题，但是思路不同

* 惩罚法：通过对违反约束的情况进行很高的惩罚，从而不必考虑约束条件。通过列出这些带惩罚项的无约束问题的最优性条件，同时让惩罚项的增加趋于无穷大时，可以得到Lagrange乘子定理;
* 消元法：把约束条件看做一个n个未知数m个方程的线性方程组(n>m)，将m个变量表示成n-m个变量的函数形式，从而化成无约束的优化问题，进而利用一阶、二阶必要性条件，也可以得到Lagrange乘子定理。

#### 惩罚法
![Snip20161201_4](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_4.png)

![Snip20161201_6](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_6.png)

#### 消元法

![Snip20161201_7](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_7.png)

![Snip20161201_8](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_8.png)

**Remark**

上述讨论说明了，在线性约束条件下，Lagrange乘子定理只是要求定义在$n-m$维空间上的无约束问题(3.12)的“零梯度性”和“Hessian阵半正定性”。

![Snip20161201_9](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_9.png)

![Snip20161201_10](http://ogfa13jyv.bkt.clouddn.com/Snip20161201_10.png)

### 最优解充分条件
利用一阶必要性条件选出来的点，有可能是局部最小值，局部最大值点乃至其他点，加上二阶必要条件可以缩小备选点。但是我们有必要给出判断局部最小点的充分条件。

 【二阶充分条件】
 假定$f$和$h$是二阶可微函数，并且$x_* \in R^n,\lambda_* \in R^m$满足
 
 $$
 \nabla_x L(x_* ,\lambda_* )=0,\nabla_\lambda L(x_* ,\lambda_* )=0\\
 x^T\nabla_{xx} L(x_* ,\lambda_* )x>0\quad 对所有满足\nabla h(x_* )x^T=0的非零x
 $$
 则$x_* $是$f$满足约束$h(x)=0$的严格局部最小值点，并且存在$\gamma,\epsilon>0$使得对任意满足$h(x)=0,\vert \vert x-x_* \vert \vert \leq \epsilon$的$x$成立
 
 $$f(x)-f(x_* )\geq \frac{\gamma}{2}\vert \vert x-x_* \vert \vert ^2$$

**Remark**

该充分条件并不需要$x_* $的正则性。

对于该命题，我们打算采取两种方法来证明，一是augmented Lagrange方法，二是可行方向法。

* augmented Lagrange方法的思想在于，通过引入augmented Lagrange函数，

	$$L_c(x,\lambda)=f(x)+\lambda^Th(x)+\frac{c}{2}\vert \vert h(x)\vert \vert ^2$$
	
	使得带约束的原问题
	
	$$\mathop{min}_{h(x)=0} f(x)$$
	
	与新问题问题
	
	$$\mathop{min}_{h(x)=0} f(x)+\frac{c}{2}\vert \vert h(x)\vert \vert ^2$$
	
	有相同的局部最优解。
* 可行方向法的思想在于，利用反正法，假设存在一系列比$x_* $更优的点，通过这些点构造方向导出矛盾。

#### augmented Lagrange方法
![Snip20161208_1](http://ogfa13jyv.bkt.clouddn.com/Snip20161208_1.png)
![Snip20161208_2](http://ogfa13jyv.bkt.clouddn.com/Snip20161208_2.png)

#### 可行方向法
![Snip20161208_3](http://ogfa13jyv.bkt.clouddn.com/Snip20161208_3.png)

