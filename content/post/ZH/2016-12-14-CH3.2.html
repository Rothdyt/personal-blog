---
title: "Lagrange乘子理论(2)"
author: Yutong Dai
date: '2016-12-14'
categories:
  - convex optimization
tags:
  - Lagrange乘子
slug: lag2
output:
  blogdown::html_page:
    toc: yes
summary: 该系列posts是笔者学习Dimitri .P Bertsekas所写的 Nonlinear Programming 2ed 中文版时整理的笔记。第三章Lagrange乘子理论内容涉及到等式约束优化问题及不等式约束优化问题。本文讨论不等式约束优化问题中的KKT条件。
---


<div id="TOC">
<ul>
<li><a>不等式约束优化问题</a><ul>
<li><a href="#karush-kuhn-tucker-">Karush-Kuhn-Tucker 必要条件</a></li>
<li><a>充分条件</a></li>
</ul></li>
</ul>
</div>

<div class="section level2">
<h2>不等式约束优化问题</h2>
<p>本节我们考虑优化问题</p>
<p><span class="math display">\[
\text{minimize}\; f(x)\qquad\qquad\qquad\qquad\\
\text{subject to}\; h_i(x)=0,i=1,2,...,m\\
\qquad\qquad g_j(x)\leq 0, j=1,2,...,r
\]</span></p>
<p>其中 <span class="math inline">\(f: R^n\;\vert \rightarrow R\)</span>, <span class="math inline">\(h_i: R^n\;\vert \rightarrow R\)</span>,<span class="math inline">\(g_j: R^n\;\vert \rightarrow R\)</span>均是连续可微的。为了记号简洁性，我们引入向量值函数<span class="math inline">\(h=(h_1,...,h_m)^T\)</span>,即<span class="math inline">\(h: R^n\;\vert \rightarrow R^m\)</span>与<span class="math inline">\(g=(g_1,...,g_r)^T\)</span>,即<span class="math inline">\(g: R^n\;\vert \rightarrow R^r\)</span>。 从而约束条件变为了 <span class="math inline">\(h(x)=0,g(x)\leq 0\)</span></p>
<div id="karush-kuhn-tucker-" class="section level3">
<h3>Karush-Kuhn-Tucker 必要条件</h3>
<div class="section level4">
<h4>直观分析</h4>
<p>一个直观的想法是，我们尽可能的扔掉一些不等式约束。事实上，若一些不等式约束不起作用（即局部最小值点在约束集的内部取得），则这些不等式约束可以忽略。举个简单的例子，考虑如下的岭回归问题</p>
<p><span class="math display">\[
\mathop{min}_\beta\qquad  \vert \vert Y-X\beta\vert \vert ^2\\
\text{subject to:}\quad  \vert \vert \beta\vert \vert \leq t
\]</span></p>
<p>当<span class="math inline">\(t\)</span>足够大时，则该不等式约束不起作用（见下图）。从而我们引出<strong>积极的不等式约束集</strong>的概念。 <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161218_3.png" alt="Snip20161218_3" /></p>
<p>对任意任意的可行点<span class="math inline">\(x\)</span>, <strong>积极的不等式约束集</strong>定义为：</p>
<p><span class="math display">\[A(x)=\{j\big\vert g_j(x)=0, j=1,2,...,r\}\]</span></p>
<p>如果<span class="math inline">\(j\notin A(x)\)</span>，则我们称第j个约束是非积极地。</p>
<p>正如上面所讨论的，若<span class="math inline">\(x^*\)</span>是优化问题的局部最小值点，那么也是该问题去掉了非积极约束后新问题的局部最小值点。（下图还是以岭回归为例做一个简要说明，表明非等式约束条件不起作用。） <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161218_4.png" alt="Snip20161218_4" /></p>
</div>
<div id="kkt-" class="section level4">
<h4>KKT 必要条件</h4>
<p>下面我们来严格的叙述下上述的结论，首先给出一个不等式版本的<strong>正则性条件</strong>： 称一个可行解<span class="math display">\[x^*\]</span>是正则的，若在该点梯度构成的向量组 <span class="math display">\[\{h_i(x^*),g_j(x^*)\big\vert  i=1,2,...,m j\in A(x^*)\}\]</span> 线性无关</p>
<p><em>KKT 必要性条件</em> 假设<span class="math display">\[x^*\]</span>是满足下面问题的局部最小值点且是正则的，</p>
<p><span class="math display">\[
\text{minimize}\; f(x)\qquad\qquad\qquad\qquad\\
\text{subject to}\; h_i(x)=0,i=1,2,...,m\\
\qquad\qquad g_j(x)\leq 0, j=1,2,...,r
\]</span></p>
<p>其中 <span class="math inline">\(f: R^n\;\vert \rightarrow R\)</span>, <span class="math inline">\(h_i: R^n\;\vert \rightarrow R\)</span>,<span class="math inline">\(g_j: R^n\;\vert \rightarrow R\)</span>均是连续可微的。那么存在唯一的Lagrange乘子<span class="math display">\[\lambda^*=(\lambda_1^*,...,\lambda_m^*),\mu^*=(\mu_1^*,...,\mu_r^*)\]</span>使得Lagrange函数<span class="math inline">\(L(x,\lambda,\mu)=f(x)+\lambda^Th(x)+\mu^Th(x)\)</span>关于<span class="math inline">\(x\)</span>的偏导数为0,即</p>
<p><span class="math display">\[
\nabla_x L(x^*,\lambda^*,\mu^*)=0\\
\mu_j\geq 0\quad j=1,...,r\\
\mu_j=0\quad j\notin A(x^*)
\]</span></p>
<p>其中<span class="math inline">\(A(x^*)\)</span>是积极的不等式约束集。如果进一步<span class="math inline">\(f,h,g\)</span>二次连续可微，则对所有满足</p>
<p><span class="math display">\[y^T\nabla h_i(x^*)=0,\forall i=1,2..,m\qquad \nabla y^Tg_j(x^*)=0,j\in A(x^*)\]</span></p>
<p>的y，我们都有</p>
<p><span class="math display">\[y^T\nabla^2_{xx} L(x^*,\lambda^*,\mu^*)y\geq 0 \]</span></p>
<p><strong>Remark</strong></p>
<ol style="list-style-type: decimal">
<li>关于<span class="math inline">\(\mu_j\geq 0\)</span>有如下几何解释 <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161219_6.png" alt="Snip20161219_6" /></li>
<li><p>在实际使用该定理的时候，我们利用一阶必要性条件</p>
<p><span class="math display">\[
\nabla_x L(x^*,\lambda^*,\mu^*)=0\\
\]</span></p>
<p>找到待选点。然后再检查每个不等式是不是积极约束。 <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161219_7.png" alt="Snip20161219_7" /> <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161219_8.png" alt="Snip20161219_8" /></p></li>
<li><p>我们称<span class="math display">\[\mu_j=0\quad j\notin A(x^*)\]</span>或者等价的<span class="math display">\[\mu_j^*g_j(x^*)=0\]</span>为互补松弛条件。</p></li>
</ol>
</div>
<div class="section level4">
<h4>转换为等式约束处理</h4>
<p>换个角度看待我们的优化问题，如果我们引入一系列的辅助变量，则可以利用第一节提到的等式约束最优性条件。具体做法是引入辅助变量<span class="math inline">\(z_1,...,z_r\)</span>并考虑如下优化问题</p>
<p><span class="math display">\[
\text{minimize}\; f(x)\qquad\qquad\qquad\qquad\\
\text{subject to}\; h_i(x)=0,i=1,2,...,m\\
\qquad\qquad g_j(x)+z_j^2=0, j=1,2,...,r
\]</span></p>
<p>若<span class="math display">\[x^*\]</span>是原问题的局部最小值，那么<span class="math display">\[(x^*,z^*)\]</span>是该问题的局部最小值，其中<span class="math display">\[z^*=(z_1^*,...,z_r^*)\]</span>且<span class="math display">\[z_j^*=\sqrt{-g_j(x^*)}\]</span>。显然当<span class="math display">\[x^*\]</span>是原问题的正则点当且仅当<span class="math display">\[(x^*,z^*)\]</span>是该问题的正则点。对于该问题我们利用等式约束版本的一阶最优性条件，我们有</p>
<p><span class="math display">\[
\nabla_x L(x^*,\lambda^*,\mu^*)=0 \qquad\qquad\\
2\mu_j^*z_j^*=0,\quad j=1,2,...,r
\]</span></p>
<p>由于对于<span class="math inline">\(j\notin A(x^*)\)</span>，有<span class="math inline">\(z_j^*&gt;0\)</span>,故最后一族等式等价于</p>
<p><span class="math display">\[\mu_j^*=0,\quad j\notin A(x^*)\]</span></p>
<p>到此，为了证明KKT的必要性条件，我们还要证明<span class="math inline">\(\mu_j\geq 0\)</span>以及二阶必要性条件。首先利用等式约束的二阶必要性条件，我们有</p>
<p><span class="math display">\[
(x,z)^T
\begin{pmatrix}
\nabla_{xx}^2L(x^*,\lambda^*,\mu^*) &amp;      0                &amp;     0            &amp; \dots     &amp;         0\\
                            0                               &amp; 2\mu_1^*       &amp;     0            &amp; \dots     &amp;         0\\
                            0                               &amp;       0               &amp;  2\mu_2^* &amp; \dots     &amp;         0\\
                            \vdots                       &amp;   \vdots           &amp;   \vdots     &amp;  \vdots  &amp;  \vdots\\
                            0                               &amp;       0               &amp;      0           &amp;  \dots   &amp;  2\mu_r^*\\
\end{pmatrix}
\begin{pmatrix}
x\\
z
\end{pmatrix}\geq 0\qquad (++)
\]</span></p>
<p>其中<span class="math inline">\(x\in R^n,z\in R^r\)</span>满足</p>
<p><span class="math display">\[x^T\nabla h_i(x^*)=0\quad x^T\nabla g_j(x^*)+2z_j^*z_j=0\quad i=1,...,m,j=1,..,r\]</span></p>
<p>选取满足如下的<span class="math inline">\((x,z)\)</span></p>
<p><span class="math display">\[
z_j=\begin{cases}
        \qquad 0\quad,  j\in A(x^*)\\
        -\frac{x^T\nabla g_j(x^*)}{2z_j^*},j\notin A(x^*)
    \end{cases}\\
x^T\nabla h_i(x^*)=0\quad x^T\nabla g_j(x^*)=0
\]</span></p>
<ul>
<li>容易检验，这样定义的<span class="math inline">\((x,z_j)\)</span>满足<span class="math display">\[x^T\nabla g_j(x^*)+2z_j^*z_j=0\]</span></li>
<li>由<span class="math inline">\(z_j\)</span>定义以及<span class="math display">\[\mu_j^*=0,j\notin A(x^*)\]</span>,则对所有的<span class="math inline">\(j\)</span>,我们有<span class="math display">\[\mu_j^*z_j=0\]</span>.</li>
</ul>
<p>将上述定义的<span class="math inline">\((x,z)\)</span>代入(++)即可证明:</p>
<p><span class="math display">\[x^T\nabla_{xx}^2L(x^*,\lambda^*,\mu^*)x\geq 0\]</span></p>
<p>至于待证的<span class="math inline">\(\mu_j\geq 0\)</span>，只需考虑<span class="math inline">\(j\in A(x^*)\)</span>的情形,这时定义<span class="math inline">\((x,z)\)</span>如下:<span class="math inline">\(x=0,z_j\neq 0\)</span>对任意<span class="math inline">\(k\neq j\)</span>,<span class="math inline">\(z_k=0\)</span>。</p>
<ul>
<li>该定义满足<span class="math display">\[x^T\nabla g_j(x^*)+2z_j^*z_j=0\]</span></li>
<li>利用(++)得到<span class="math display">\[\mu_j\geq 0,\forall j\in A(x^*)\]</span></li>
</ul>
</div>
</div>
<div class="section level3">
<h3>充分条件</h3>
<div class="section level4">
<h4>二阶充分条件</h4>
<p>假定<span class="math inline">\(f: R^n\;\vert \rightarrow R\)</span>, <span class="math inline">\(h_i: R^n\;\vert \rightarrow R\)</span>,<span class="math inline">\(g_j: R^n\;\vert \rightarrow R\)</span>均是连续且二次可微的,并且<span class="math display">\[x^*\in R^n,\lambda^*\in R^m,\mu^*\in R^r\]</span>满足</p>
<p><span class="math display">\[
\nabla_x (x^*,\lambda^*,\mu^*)=0 \qquad  h(x^*)=0 \qquad g(x^*)\leq 0\\
\mu_j^*&gt; 0, j\in A(x^*) \quad \mu_j^*=0,j\notin A(x^*)\\
y^T\nabla_{xx}^2L(x^*,\lambda^*,\mu^*)y\geq 0 \qquad\qquad\quad
\]</span></p>
<p>其中<span class="math inline">\(y\neq 0\)</span>并且使得</p>
<p><span class="math display">\[y^T\nabla h_i(x^*)=0,\forall i=1,...,m \quad y^T\nabla g_j(x^*)=0,\forall j\in A(x^*)\]</span></p>
<p>那么<span class="math display">\[x^*\]</span>是<span class="math inline">\(f\)</span>满足约束条件下的严格局部最小值点。</p>
<p><strong>Remark</strong></p>
<ol style="list-style-type: decimal">
<li>定理的证明可以将不等式约束换成等式约束，然后利用等式约束版本的二阶充分性条件即可证明。</li>
<li>条件<span class="math display">\[\mu_j^*&gt; 0, j\in A(x^*)\]</span>被称作<strong>严格的互补松弛条件</strong></li>
</ol>
</div>
<div class="section level4">
<h4>一般充分条件</h4>
<p>到目前为止，我们讨论的二阶条件都需要二阶导数存在的假设，在研究无约束优化问题时，我们知道一阶最优性条件加上凸性即可保证最优解的充分性。带约束的问题，也存在类似的定理。事实上，我们甚至不需要凸性以及可微性的假设，而只需要一个最小化Lagrange函数的条件。</p>
<p><strong>一般充分性条件</strong></p>
<p>考虑如下优化问题</p>
<p><span class="math display">\[
\text{minimize}\; f(x)\qquad\quad\qquad \\
\text{subject to}\; x\in X \qquad\qquad\\
\qquad\qquad\qquad g_j(x)\leq0, j=1,2,...,r
\]</span></p>
<p>其中<span class="math inline">\(f,g_j\)</span>定义在<span class="math display">\[R^n\]</span>上的实值函数,<span class="math inline">\(X\)</span>是给定的<span class="math display">\[R^n\]</span>的子集。假设<span class="math display">\[x^*\]</span>是该问题的一个可行解,<span class="math display">\[\mu^*=(\mu_1^*,...,\mu_r^*)\]</span>是给定的向量，并且满足:</p>
<p><span class="math display">\[
\mu_j\geq 0\quad j=1,...,r\\
\mu_j=0\quad j\notin A(x^*)
\]</span></p>
<p>而且<span class="math display">\[x^*\]</span>是Lagrange函数<span class="math inline">\(L(x,\mu^*)\)</span>在<span class="math inline">\(X\)</span>上的最小值，则<span class="math display">\[x^*\]</span>是该问题的全局最小值。 <img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161219_13.png" alt="Snip20161219_13" /></p>
</div>
</div>
</div>
