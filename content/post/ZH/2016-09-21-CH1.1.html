---
title: "无约束优化(1)"
author: Yutong Dai
date: '2016-09-21'
categories:
  - convex optimization
tags:
  - 无约束优化
slug: uncon1
output:
  blogdown::html_page:
    toc: yes
summary: 该系列posts是笔者学习Dimitri .P Bertsekas所写的 Nonlinear Programming 2ed 中文版时整理的笔记。第一章无约束优化内容涉及到最优性条件、梯度方法、牛顿法与变形以及共轭方向法。本文讨论最优性条件。
---


<div id="TOC">
<ul>
<li><a>最优性条件</a><ul>
<li><a>最优解的存在性</a></li>
<li><a>最优性条件的直观分析</a></li>
<li><a>为什么需要最优性条件</a></li>
</ul></li>
</ul>
</div>

<div class="section level2">
<h2>最优性条件</h2>
<p>我们讨论最优性条件的最直接的目的是为了知道满足什么样条件的点就是满足最小化问题的最优解。</p>
<div class="section level3">
<h3>最优解的存在性</h3>
<p>很多情况下函数的全局极小值点很可能不存在，所以我们有必要讨论最优解的存在性问题。为说明这个问题，我们需要引入一些概念和Weistrass定理。</p>
<ul>
<li><p>【下半连续(lower semicontinuous)】 实值函数<span class="math inline">\(f: X \vert \rightarrow R\)</span>被称作在<span class="math inline">\(x\in X\)</span>处下半连续的，若对于每一个收敛到<span class="math inline">\(x\)</span>的序列<span class="math inline">\(\{x_k\}\subset X\)</span>，都有<span class="math inline">\(\liminf_{k\rightarrow +\infty} f(x_k)\geq f(x)\)</span>.</p></li>
<li><p>【强制(coercive)】 函数<span class="math inline">\(f: X \vert \rightarrow R\)</span>被称作是强制的，如果对于每一个满足 <span class="math inline">\(\vert \vert x_k\vert \vert \rightarrow +\infty\)</span>的序列序列<span class="math inline">\(\{x_k\}\subset X\)</span>，都有<span class="math inline">\(\lim_{k\rightarrow +\infty} f(x_k)=\infty\)</span>.</p></li>
<li><p>【Weierstrass定理】令<span class="math inline">\(X\)</span>为<span class="math inline">\(R^n\)</span>的非空子集，<span class="math inline">\(f: X \vert \rightarrow R\)</span>在 X的所有点处下半连续。当下面三个条件</p>
<ul>
<li>X是紧集（闭且有界）</li>
<li>X是闭集且 <span class="math inline">\(f\)</span> 是强制的</li>
<li>存在一个标量<span class="math inline">\(a\)</span>，使得截集<span class="math inline">\(\{x\in X\vert f(x)\leq a\}\)</span>为非空紧集</li>
</ul>
<p>中的任何一个满足时，<span class="math inline">\(f\)</span> 在 <span class="math inline">\(X\)</span>上的最小值点的集合为非空紧集。</p></li>
</ul>
<p>通过Weierstrass定理我们知道，在无约束的问题中由于定义域是全空间，自然条件：X是紧集（闭且有界）是不能满足的。但是当 <span class="math inline">\(f\)</span>性质足够好的时候我们可以保证存在全局最小值点。</p>
</div>
<div class="section level3">
<h3>最优性条件的直观分析</h3>
<p><strong>下面都是直观分析，所有推导并不严谨，但是结果确实是可以被严格证明的。具体证明可以参考 Dimitri .P Bertsekas, Nonlinear Programming 2ed 中文版p10-p11</strong></p>
<p>如果目标函数可微，我们可以考虑用Taylor展式去分析函数在可微点以及其领域的变化情况。假设$x_* <span class="math inline">\(是局部最小值点，考虑一个扰动\)</span>x_* +x$, 利用Taylor展式可以得到一个线性近似</p>
<p><span class="math display">\[f(x_* +\Delta x)-f(x_* )\approx  (\Delta x)^T\nabla f(x_* )\]</span></p>
<p>由于$x_* $是局部最小值点，则近似的有</p>
<p><span class="math display">\[(\Delta x)^T\nabla f(x_* )=\sum_{i=1}^n \frac{\partial f(x_* )}{\partial x_i}\Delta x_i \geq 0\]</span></p>
<p>取对i=1,2,…,n，取<span class="math inline">\(\Delta x=ae_i\)</span>，其中<span class="math inline">\(e_i\)</span>是<span class="math inline">\(R^n\)</span>的单位向量且<span class="math inline">\(a&gt;0\)</span>，代入上式，则对所有的i，</p>
<p><span class="math display">\[\frac{\partial f(x_* )}{\partial x_i}\geq 0\]</span></p>
<p>同样取<span class="math inline">\(\Delta x=-ae_i\)</span>,代入上式，则对所有的i，</p>
<p><span class="math display">\[\frac{\partial f(x_* )}{\partial x_i}\leq 0\]</span></p>
<p>于是得到 <span class="math inline">\(\nabla f(x_* )=0\)</span>，这个被称为<em>一阶最优性条件</em>。</p>
<p>进一步我们用二阶Taylor展式去刻画函数值的变化则有</p>
<p><span class="math display">\[f(x_* +\Delta x)-f(x_* )\approx  (\Delta x)^T\nabla f(x_* )+\frac{1}{2} (\Delta x)^T \nabla^2 f(x_* ) \Delta x\]</span></p>
<p>同样的，由于$x_* $是局部最小值点，则近似的有</p>
<p><span class="math display">\[(\Delta x)^T\nabla f(x_* )+\frac{1}{2} (\Delta x)^T \nabla^2 f(x_* ) \Delta x\geq 0\]</span></p>
<p>当一阶最优性条件满足时，进一步有</p>
<p><span class="math display">\[\frac{1}{2} (\Delta x)^T \nabla^2 f(x_* ) \Delta x\geq 0\]</span></p>
<p>于是推出<span class="math inline">\(\nabla^2 f(x_* )\)</span>半正定，这个被称为<em>二阶最优性条件</em>。</p>
<p>特别的，如果<span class="math inline">\(f\)</span>是凸函数，那么一阶最优性条件 <span class="math inline">\(\nabla f(x_* )=0\)</span>也是最优性的充分条件。但是如果凸性不满足，则不成立。比如，</p>
<div class="figure">
<img src="http://ogfa13jyv.bkt.clouddn.com/Snip20161109_6.png" alt="Illustration: violation of the convexity." />
<p class="caption">Illustration: violation of the convexity.</p>
</div>
<p>我们以定理的形式总结下上面讨论的内容，具体的证明略去，掌握想法最重要。</p>
<ul>
<li><p>【最优性的必要条件】 令$x_* $为 <span class="math inline">\(f:R^n\vert \rightarrow R\)</span>的无约束局部最小值点，并且假设 <span class="math inline">\(f\)</span>在开集 <span class="math inline">\(S\)</span>上连续可微，<span class="math inline">\(x_* \in S\)</span>,那么有<span class="math inline">\(\nabla f(x_* )=0\)</span>。如果<span class="math inline">\(f\)</span>在开集 <span class="math inline">\(S\)</span>上二阶连续可微，则有<span class="math inline">\(\nabla^2 f(x_* )\)</span>半正定。</p>
<p><strong>Remark</strong> 注意这里需要 <span class="math inline">\(S\)</span> 是开集，这一条件会导致无约束的最优性条件和带约束的最优性条件产生区别。因为这时 候最优点是内点，具体我们还会在Chapter 2里面讨论。</p></li>
<li><p>【最优性的充分条件】 令 <span class="math inline">\(f:X\vert \rightarrow R\)</span>为开集 <span class="math inline">\(X\)</span> 上的一个二阶可微函数，假设向量<span class="math inline">\(x_* \in S\)</span>满足条件<span class="math inline">\(\nabla f(x_* )=0,\nabla^2 f(x_* )\)</span>正定。那么$x_* $是 <span class="math inline">\(f\)</span> 的严格无约束局部最小值点。特别，存在标量<span class="math inline">\(a,\epsilon\)</span> 使得<span class="math inline">\(\forall x\in \{x\vert \vert \vert x-x_* \vert \vert &lt;\epsilon\}\)</span>,成立</p>
<p><span class="math display">\[f(x)\geq f(x_* )+\frac{a}{2} \vert \vert x-x_* \vert \vert ^2\]</span></p></li>
</ul>
<p>特别的凸函数有更加好的性质，</p>
<ul>
<li>【凸函数的最优性条件】 令 <span class="math inline">\(f:X\vert \rightarrow R\)</span>为凸集 <span class="math inline">\(X\)</span> 上的一个凸函数。则
<ul>
<li>在 <span class="math inline">\(X\)</span>上的 <span class="math inline">\(f\)</span>最小值点也是 <span class="math inline">\(X\)</span>上的全局最小值点，如果 <span class="math inline">\(f\)</span> 是严格凸的，那么至多存在<span class="math inline">\(X\)</span>上的一个全局最小值点。</li>
<li>如果 <span class="math inline">\(X\)</span> 是开集， 那么向量 <span class="math inline">\(x_* \in X\)</span>是 <span class="math inline">\(f\)</span>在 <span class="math inline">\(X\)</span> 上的全局最优解得充要条件是 <span class="math inline">\(\nabla f(x_* )=0\)</span></li>
</ul></li>
</ul>
</div>
<div class="section level3">
<h3>为什么需要最优性条件</h3>
<p>一般来说，在解决最优化问题时，我们可以利用一阶最优性条件，找到一切满足 <span class="math inline">\(\nabla f(x)=0\)</span>的解， 对这些解，逐点检查二阶导数<span class="math inline">\(\nabla^2 f(x)\)</span>是否正定，如果存在某个解使得二阶导数正定，则其为唯一全局最小值点。然而需要指出的是，往往求解<span class="math inline">\(\nabla f(x)=0\)</span>是非常复杂的。除非考虑迭代求解算法，否则最优性条件的有效性并不明显。</p>
<p>但是从另外一个角度看，很多寻找最小值点的算法，通过判断当前解是否是满足各种最优性条件来判断当前解是否是最优解，并且达到最优解算法停止。另外，充分条件在分析算法收敛速度中发挥了重要作用。</p>
<p>（该小节完）</p>
</div>
</div>
